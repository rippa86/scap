---
# tasks file for scap
- ansible.builtin.debug: 
    var: dir_name
- ansible.builtin.debug:
    var: oscap_hostname

- name: run scap report
  ansible.builtin.shell:
    oscap xccdf eval --profile {{ profile }} \
    --fetch-remote-resources \
    --results-arf /tmp/openscap/{{ dir_name }}_results/{{ oscap_hostname }}_arf.xml \
    --report /tmp/openscap/{{ dir_name }}_results/{{ oscap_hostname }}.html \
    /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml
  ignore_errors: true
  register: oscap_result
  become: true

- name: dubug result da
  ansible.builtin.debug:
    var: oscap_result